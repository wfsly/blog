---
layout: post
title:  深入剖析kubernetes学习笔记1-容器基础
description: 
modified:   2020-01-30 15:32:32
tags: [kubernetes]
---

<!-- TOC -->

[1 容器基础](#1-容器基础)

<!-- /TOC -->

# 1.容器基础
1. Namespace对资源进行隔离

 通过容器启动的应用程序进程，容器通过pid namespace技术，在容器应用程序的进程空间中将应用程序的pid改为了1,但在宿主机的进程空间中，此进程的pid依然是宿主机分配的pid. 容器利用linux多种资源的namespace(mount, UTS, IPC,Network,User)将容器中的应用程序的资源和宿主机进行隔离

 所以，Docker容器这个概念，实际上就是在创建容器进程时，指定了这个进程需要启用的一组namespace参数，这样容器就只能"看"当前Namespace所限定的资源，文件，设备，状态或者配置。容器其实是一种特殊的进程而已

2. 容器vs虚拟机

优点:
容器比虚拟机性能高，资源消耗少。
 - 虚拟机是通过hypervisor对宿主机资源做虚拟化，里面需要运行一个完整的操作系统才能执行用户的应用程序。不可避免的带来了额外的资源消耗和占用。
 - 虚拟机内的程序调用计算，网络，I/O资源需要通过虚拟化软件去间接调用宿主机资源，增加了性能损耗
 - 容器实际上还是跑在宿主机系统上的一个进程，直接使用宿主机的计算，网络，I/O资源,不存在虚拟机的性能损耗。
 - 容器以namespace技术进行隔离，额外的资源占用可以忽略估计

缺点：
 容器隔离不彻底
 - 多个容器中间是共享的宿主机linux内核, 无法在windows宿主机上运行linux容器，无法在低版本的linux宿主机上运行高版本的linux容器
 - linux内核中，有很多资源和对象不能被Namespace化。比如时间,如果某个容器程序修改了时间，整个宿主机的时间都会被修改.虚拟机则可以随便更改

 3. Cgroups设置资源限制

 为什么要限制资源?
 容器启动的进程在容器进程空间里虽然pid是1，但是在宿主机上依然是宿主机给分配的pid，和宿主机上其他进程是平等的竞争关系，其所使用的宿主机资源可以被其他进程抢占，也可以抢占其他进程的资源。因此需要对容器使用的资源进行限制

 Cgroups 全名linux control group, 最主要的作用，就是限制一个进程组能够使用的资源上限，包括CPU，磁盘，内存，网络带宽等等

 4. 容器镜像

容器镜像其实是一个用来为容器应用进程提供隔离后执行环境的文件系统，rootfs。

5. Docker容器

 # 2.