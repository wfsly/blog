---
layout: post
title:  docker常用指令
description: 
modified:   2019-11-28 16:18:31
tags: [docker]
---

## 镜像制作
1. 创建指定name:tag的镜像
`docker build -t name:tag .`

## 容器运行
2. 使用镜像hello:v1 后台启动名字为hello容器, 将本地8011端口映射到容器8021端口
`docker run --name hello -d -p 8011:8021 hello:v1`
挂在本地目录到容器内使用
`docker run -v  /home/conf:/etc/hello --name hello -d -p 8011:8021 hello:v1`

3. 查看镜像日志
`docker logs name/container_id`
4. 进入容器
`docker exec -it name/container_id bash/sh`

## docker-compose

使用docker-compose组合启动多个服务时，各服务之前互通连接，要使用服务在容器内启用的端口，而不是使用对外暴露的端口。因为容器间
都在容器的子网段内，不能连对主机暴露的端口

使用docker-compose启动多个服务时，要注意启动顺序，docker-compose暂不支持服务的延迟等待的功能。
遇到的实际问题，web server和mysql同时启动，由于Mysql正常运行还需要一定的启动时间，所以web server总是报connection refused的错误
